'use strict';function _0x5729(_0x4f9ad6,_0x38e20e){var _0x522fc3=_0x522f();return _0x5729=function(_0x57296f,_0x16b097){_0x57296f=_0x57296f-0xea;var _0x3e59c1=_0x522fc3[_0x57296f];return _0x3e59c1;},_0x5729(_0x4f9ad6,_0x38e20e);}var _0x2b4e27=_0x5729;(function(_0x349c39,_0xae0283){var _0x587881=_0x5729,_0x1854e9=_0x349c39();while(!![]){try{var _0x4b0468=-parseInt(_0x587881(0xf7))/0x1+parseInt(_0x587881(0x12a))/0x2*(parseInt(_0x587881(0x102))/0x3)+-parseInt(_0x587881(0x107))/0x4+-parseInt(_0x587881(0x118))/0x5+parseInt(_0x587881(0x123))/0x6*(-parseInt(_0x587881(0xec))/0x7)+-parseInt(_0x587881(0x115))/0x8+parseInt(_0x587881(0x10c))/0x9;if(_0x4b0468===_0xae0283)break;else _0x1854e9['push'](_0x1854e9['shift']());}catch(_0x5c409d){_0x1854e9['push'](_0x1854e9['shift']());}}}(_0x522f,0xb4560));function _0x522f(){var _0x248e41=['正在创建账户表','__metadata','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20user_login\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INT\x20AUTO_INCREMENT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20user_name\x20VARCHAR(50)\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20password\x20VARCHAR(255)\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20admin\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20updated_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20ON\x20UPDATE\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200\x0a\x20\x20\x20\x20)','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20event_info(\x0a\x20\x20\x20\x20\x20\x20id\x20VARCHAR(40)\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20event_id\x20VARCHAR(128)\x20NOT\x20NULL\x20COMMENT\x20\x27事件id\x27,\x0a\x20\x20\x20\x20\x20\x20event_name\x20VARCHAR(128)\x20DEFAULT\x20\x27\x27\x20COMMENT\x20\x27事件名称\x27,\x0a\x20\x20\x20\x20\x20\x20event_des\x20VARCHAR(128)\x20DEFAULT\x20\x27\x27\x20COMMENT\x27事件描述\x27,\x0a\x20\x20\x20\x20\x20\x20event_status\x20INT(2)\x20DEFAULT\x200\x20NOT\x20NULL\x20COMMENT\x20\x27事件状态\x20计算中(0)/暂停计算(1)/未注册(2)\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20update_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20\x20ON\x20UPDATE\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index\x20(app_id,event_id)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','1533848cyMCcl','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_online_new_trendline(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20date\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27日期\x27,\x0a\x20\x20\x20\x20\x20\x20`index`\x20INT(5)\x20NOT\x20NULL\x20COMMENT\x20\x27时间下标\x27,\x0a\x20\x20\x20\x20\x20\x20time\x20INT(1)\x20NOT\x20NULL\x20COMMENT\x20\x271-30秒\x202-分钟\x203-小时\x204-天\x27,\x0a\x20\x20\x20\x20\x20\x20value\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27数值\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index(app_id,date,time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','entityManager','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_user\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20year\x20INT(4)\x20NOT\x20NULL\x20COMMENT\x20\x27年分\x27,\x0a\x20\x20\x20\x20\x20\x20type\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x271-天\x202-周\x203-月\x204-季\x205-年\x27,\x0a\x20\x20\x20\x20\x20\x20idx\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x27下标\x27,\x0a\x20\x20\x20\x20\x20\x20start_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27开始时间\x27,\x0a\x20\x20\x20\x20\x20\x20end_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27结束时间\x27,\x0a\x20\x20\x20\x20\x20\x20uv\x20int(11)\x20NOT\x20NULL\x20COMMENT\x20\x27活跃数\x27,\x0a\x20\x20\x20\x20\x20\x20new_uv\x20int(11)\x20NOT\x20NULL\x20COMMENT\x20\x27新增数\x27,\x0a\x20\x20\x20\x20\x20\x20total\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27累计活跃\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index\x20(app_id,type,year,idx)\x20USING\x20BTREE,\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_day_index\x20(app_id,type,start_time)\x20USING\x20BTREE\x0a\x20\x20\x20)','../../shared/service/clickhouse/clickhouse.service','25117875wxNwii','getOwnPropertyDescriptor','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_session_duration(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20year\x20INT(4)\x20NOT\x20NULL\x20COMMENT\x20\x27年分\x27,\x0a\x20\x20\x20\x20\x20\x20type\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x271-天\x202-周\x203-月\x204-季\x205-年\x27,\x0a\x20\x20\x20\x20\x20\x20idx\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x27下标\x27,\x0a\x20\x20\x20\x20\x20\x20start_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27开始时间\x27,\x0a\x20\x20\x20\x20\x20\x20end_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27结束时间\x27,\x0a\x20\x20\x20\x20\x20\x20pv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27会话个数\x27,\x0a\x20\x20\x20\x20\x20\x20level\x20VARCHAR(10)\x20NOT\x20NULL\x20COMMENT\x20\x27会话区间等级\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index\x20(app_id,type,year,idx)\x20USING\x20BTREE,\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_day_index\x20(app_id,type,start_time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','__decorate','初始化设备信息','正在创建会话频次统计表','BootstrapService','正在创建在线用户分时峰值统计表','defineProperty','8858448BKkccO','正在创建设备映射表','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_location(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20year\x20INT(4)\x20NOT\x20NULL\x20COMMENT\x20\x27年分\x27,\x0a\x20\x20\x20\x20\x20\x20type\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x271-天\x202-周\x203-月\x204-季\x205-年\x27,\x0a\x20\x20\x20\x20\x20\x20idx\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x27下标\x27,\x0a\x20\x20\x20\x20\x20\x20start_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27开始时间\x27,\x0a\x20\x20\x20\x20\x20\x20end_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27结束时间\x27,\x0a\x20\x20\x20\x20\x20\x20country\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27国家\x27,\x0a\x20\x20\x20\x20\x20\x20prov\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27省份\x27,\x0a\x20\x20\x20\x20\x20\x20city\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27城市\x27,\x0a\x20\x20\x20\x20\x20\x20district\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27区域\x27,\x0a\x20\x20\x20\x20\x20\x20uv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27用户活跃数\x27,\x0a\x20\x20\x20\x20\x20\x20new_uv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27新用户活跃数\x27,\x0a\x20\x20\x20\x20\x20\x20pv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27访问数\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index\x20(app_id,type,country,prov,city,year,idx)\x20USING\x20BTREE,\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_day_index\x20(app_id,type,country,prov,city,start_time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','3822175oFVxgx','正在创建redis合并记录表','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_metrics\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20year\x20INT(4)\x20NOT\x20NULL\x20COMMENT\x20\x27年分\x27,\x0a\x20\x20\x20\x20\x20\x20type\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x271-天\x202-周\x203-月\x204-季\x205-年\x27,\x0a\x20\x20\x20\x20\x20\x20idx\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x27下标\x27,\x0a\x20\x20\x20\x20\x20\x20start_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27开始时间\x27,\x0a\x20\x20\x20\x20\x20\x20end_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27结束时间\x27,\x0a\x20\x20\x20\x20\x20\x20metrics_type\x20VARCHAR(32)\x20NOT\x20NULL\x20COMMENT\x20\x27终端类型\x27,\x0a\x20\x20\x20\x20\x20\x20value\x20VARCHAR(512)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27终端类型值\x27,\x0a\x20\x20\x20\x20\x20\x20pv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27启动次数\x27,\x0a\x20\x20\x20\x20\x20\x20new_uv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27新增新用\x27,\x0a\x20\x20\x20\x20\x20\x20uv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27活跃用户\x27,\x0a\x20\x20\x20\x20\x20\x20total\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27累计活跃\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x20\x270\x27,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index\x20(app_id,type,metrics_type,value,year,idx)\x20USING\x20BTREE,\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_day_index\x20(app_id,type,metrics_type,value,start_time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','log','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_online_active_agg(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20date\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27日期\x27,\x0a\x20\x20\x20\x20\x20\x20`index`\x20INT(5)\x20NOT\x20NULL\x20COMMENT\x20\x27时间下标\x27,\x0a\x20\x20\x20\x20\x20\x20time\x20INT(1)\x20NOT\x20NULL\x20COMMENT\x20\x271-30秒\x202-分钟\x203-小时\x27,\x0a\x20\x20\x20\x20\x20\x20value\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27数值\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index(app_id,date,time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20app_job_record(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20date\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27日期\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index\x20(app_id,date)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20event_seg_info(\x0a\x20\x20\x20\x20\x20\x20id\x20VARCHAR(40)\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20event_id\x20VARCHAR(128)\x20NOT\x20NULL\x20COMMENT\x20\x27事件id\x27,\x0a\x20\x20\x20\x20\x20\x20seg_id\x20VARCHAR(128)\x20NOT\x20NULL\x20COMMENT\x20\x27事件属性id\x27,\x0a\x20\x20\x20\x20\x20\x20seg_name\x20VARCHAR(128)\x20\x20COMMENT\x20\x27属性名称\x27,\x0a\x20\x20\x20\x20\x20\x20seg_status\x20INT(2)\x20DEFAULT\x200\x20NOT\x20NULL\x20COMMENT\x20\x27属性状态\x20计算中(0)/暂停计算(1)/未注册(2)\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20update_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20\x20ON\x20UPDATE\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index\x20(app_id,event_id,seg_name)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','object','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20online_redis_clear\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20date\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27日期\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index(app_id,date)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','typeorm','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_page_bounce(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20year\x20INT(4)\x20NOT\x20NULL\x20COMMENT\x20\x27年分\x27,\x0a\x20\x20\x20\x20\x20\x20type\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x271-天\x202-周\x203-月\x204-季\x205-年\x27,\x0a\x20\x20\x20\x20\x20\x20idx\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x27下标\x27,\x0a\x20\x20\x20\x20\x20\x20start_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27开始时间\x27,\x0a\x20\x20\x20\x20\x20\x20end_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27结束时间\x27,\x0a\x20\x20\x20\x20\x20\x20name\x20VARCHAR(128)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27页面名称\x27,\x0a\x20\x20\x20\x20\x20\x20uv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27用户活跃数\x27,\x0a\x20\x20\x20\x20\x20\x20new_uv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27新用户活跃数\x27,\x0a\x20\x20\x20\x20\x20\x20pv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27访问数\x27,\x0a\x20\x20\x20\x20\x20\x20bounce\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27跳出数\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index\x20(app_id,type,name,year,idx)\x20USING\x20BTREE,\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_day_index\x20(app_id,type,name,start_time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20\x20)','32424QLHEAT','../../shared/service/base.service','clickhouse','正在创建终端统计表','metadata','正在创建事件信息表','Injectable','38elVpBn','正在创建会话统计表','Logger','query','正在创建累计日活分时统计表','正在创建页面统计表','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20ip_info\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20ip\x20VARCHAR(40)\x20NOT\x20NULL\x20COMMENT\x20\x27IP地址\x27,\x0a\x20\x20\x20\x20\x20\x20country\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27国家\x27,\x0a\x20\x20\x20\x20\x20\x20country_id\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27国家id\x27,\x0a\x20\x20\x20\x20\x20\x20isp\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27来源\x27,\x0a\x20\x20\x20\x20\x20\x20area\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27省份片区\x20华东华南\x27,\x0a\x20\x20\x20\x20\x20\x20region\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27省份\x27,\x0a\x20\x20\x20\x20\x20\x20region_id\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27省份id\x27,\x0a\x20\x20\x20\x20\x20\x20city\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27城市\x27,\x0a\x20\x20\x20\x20\x20\x20city_id\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27城市id\x27,\x0a\x20\x20\x20\x20\x20\x20district\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27区\x27,\x0a\x20\x20\x20\x20\x20\x20district_id\x20VARCHAR(64)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27区id\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x20\x270\x27,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20KEY\x20ip_index\x20(ip)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','正在创建用户统计表','正在创建新增用户分时统计表','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_page(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20year\x20INT(4)\x20NOT\x20NULL\x20COMMENT\x20\x27年分\x27,\x0a\x20\x20\x20\x20\x20\x20type\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x271-天\x202-周\x203-月\x204-季\x205-年\x27,\x0a\x20\x20\x20\x20\x20\x20idx\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x27下标\x27,\x0a\x20\x20\x20\x20\x20\x20start_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27开始时间\x27,\x0a\x20\x20\x20\x20\x20\x20end_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27结束时间\x27,\x0a\x20\x20\x20\x20\x20\x20name\x20VARCHAR(128)\x20DEFAULT\x20NULL\x20COMMENT\x20\x27页面名称\x27,\x0a\x20\x20\x20\x20\x20\x20uv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27用户活跃数\x27,\x0a\x20\x20\x20\x20\x20\x20new_uv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27新用户活跃数\x27,\x0a\x20\x20\x20\x20\x20\x20pv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27访问数\x27,\x0a\x20\x20\x20\x20\x20\x20total_duration\x20BIGINT\x20UNSIGNED\x20NOT\x20NULL\x20COMMENT\x20\x27今日访问总时长\x27,\x0a\x20\x20\x20\x20\x20\x20avg_duration\x20DECIMAL(10,\x202)\x20NOT\x20NULL\x20COMMENT\x20\x27今日平均访问时长\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index\x20(app_id,type,name,year,idx)\x20USING\x20BTREE,\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_day_index\x20(app_id,type,name,start_time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20device_mapping\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(2)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20device\x20VARCHAR(64)\x20NOT\x20NULL\x20COMMENT\x20\x27设备编码\x27,\x0a\x20\x20\x20\x20\x20\x20name\x20VARCHAR(128)\x20NOT\x20NULL\x20COMMENT\x20\x27设备名称\x27,\x0a\x20\x20\x20\x20\x20\x20vendor\x20VARCHAR(40)\x20NOT\x20NULL\x20COMMENT\x20\x27设备厂商\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20device_index\x20(device)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','function','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20online_redis_merge(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20date\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27日期\x27,\x0a\x20\x20\x20\x20\x20\x20`index`\x20INT(5)\x20NOT\x20NULL\x20COMMENT\x20\x27时间下标\x27,\x0a\x20\x20\x20\x20\x20\x20time\x20INT(1)\x20NOT\x20NULL\x20COMMENT\x20\x271-30秒\x202-分钟\x203-小时\x204-天\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index(app_id,date,time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','56YgkvxG','正在创建打开次数分时统计表','__esModule','MetricsService','BaseService','../../metrics-module/service/metrics.service','正在创建任务表','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20app_user_bitmap\x0a\x20\x20\x20\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20app_id\x20String\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20day\x20DateTime\x20COMMENT\x20\x27日期\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20is_new_user\x20tinyint(1)\x20COMMENT\x20\x27新用户标识\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_bitmap\x20AggregateFunction(groupBitmap,\x20UInt32)\x20COMMENT\x20\x27位图\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20INDEX\x20day_index\x20day\x20TYPE\x20minmax\x20GRANULARITY\x208192,\x0a\x20\x20\x20\x20\x20\x20\x20\x20INDEX\x20new_user_index\x20is_new_user\x20TYPE\x20minmax\x20GRANULARITY\x208192\x0a\x20\x20\x20\x20)\x20ENGINE\x20=\x20MergeTree()\x0a\x20\x20\x20\x20\x20\x20primary\x20key\x20(app_id)\x0a\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20(app_id,\x20day)\x0a\x20\x20\x20\x20','正在创建应用用户位图表','logger','正在创建redis任务记录表','959049TLTvIJ','decorate','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_online_open_trendline(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20date\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27日期\x27,\x0a\x20\x20\x20\x20\x20\x20`index`\x20INT(5)\x20NOT\x20NULL\x20COMMENT\x20\x27时间下标\x27,\x0a\x20\x20\x20\x20\x20\x20time\x20INT(1)\x20NOT\x20NULL\x20COMMENT\x20\x271-30秒\x202-分钟\x203-小时\x204-天\x27,\x0a\x20\x20\x20\x20\x20\x20value\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27数值\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index(app_id,date,time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)','length','正在创建ip信息表','ClickhouseService','metricsService','EntityManager','design:paramtypes','bootstrap','setup','190305YEJnqX'];_0x522f=function(){return _0x248e41;};return _0x522f();}var __decorate=this&&this[_0x2b4e27(0x10f)]||function(_0x346c6d,_0x3369a7,_0x38ac8d,_0xa7dead){var _0x4cd2d8=_0x2b4e27,_0x413884=arguments['length'],_0x471387=_0x413884<0x3?_0x3369a7:_0xa7dead===null?_0xa7dead=Object[_0x4cd2d8(0x10d)](_0x3369a7,_0x38ac8d):_0xa7dead,_0x1dd2fa;if(typeof Reflect===_0x4cd2d8(0x11f)&&typeof Reflect[_0x4cd2d8(0xf8)]==='function')_0x471387=Reflect['decorate'](_0x346c6d,_0x3369a7,_0x38ac8d,_0xa7dead);else{for(var _0x2de465=_0x346c6d[_0x4cd2d8(0xfa)]-0x1;_0x2de465>=0x0;_0x2de465--)if(_0x1dd2fa=_0x346c6d[_0x2de465])_0x471387=(_0x413884<0x3?_0x1dd2fa(_0x471387):_0x413884>0x3?_0x1dd2fa(_0x3369a7,_0x38ac8d,_0x471387):_0x1dd2fa(_0x3369a7,_0x38ac8d))||_0x471387;}return _0x413884>0x3&&_0x471387&&Object[_0x4cd2d8(0x114)](_0x3369a7,_0x38ac8d,_0x471387),_0x471387;},__metadata=this&&this[_0x2b4e27(0x104)]||function(_0x1ca59c,_0x24ca61){var _0x2b4a8c=_0x2b4e27;if(typeof Reflect===_0x2b4a8c(0x11f)&&typeof Reflect[_0x2b4a8c(0x127)]===_0x2b4a8c(0xea))return Reflect[_0x2b4a8c(0x127)](_0x1ca59c,_0x24ca61);},BootstrapService_1;Object[_0x2b4e27(0x114)](exports,_0x2b4e27(0xee),{'value':!![]}),exports[_0x2b4e27(0x112)]=void 0x0;const common_1=require('@nestjs/common'),typeorm_1=require(_0x2b4e27(0x121)),base_service_1=require(_0x2b4e27(0x124)),clickhouse_service_1=require(_0x2b4e27(0x10b)),metrics_service_1=require(_0x2b4e27(0xf1));let BootstrapService=BootstrapService_1=class BootstrapService extends base_service_1[_0x2b4e27(0xf0)]{constructor(_0x51f966,_0x324c26,_0x1a860c){var _0xcbe140=_0x2b4e27;super(),this['entityManager']=_0x51f966,this[_0xcbe140(0x125)]=_0x324c26,this[_0xcbe140(0xfd)]=_0x1a860c,this['logger']=new common_1[(_0xcbe140(0x12c))](BootstrapService_1['name']);}async[_0x2b4e27(0x100)](){var _0xe5b434=_0x2b4e27;this[_0xe5b434(0xf5)]['log'](_0xe5b434(0x103)),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0x105)),this['logger'][_0xe5b434(0x11b)]('正在创建应用表'),await this[_0xe5b434(0x109)]['query']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20apps(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20name\x20VARCHAR(64)\x20NOT\x20NULL\x20COMMENT\x20\x27应用名称\x27,\x0a\x20\x20\x20\x20\x20\x20type\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x27应用类型\x27,\x0a\x20\x20\x20\x20\x20\x20app_key\x20VARCHAR(40)\x20NOT\x20NULL\x20COMMENT\x20\x27应用key\x27,\x0a\x20\x20\x20\x20\x20\x20salt\x20VARCHAR(16)\x20NOT\x20NULL\x20COMMENT\x20\x27应用盐值\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20job\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x201\x20COMMENT\x20\x27统计任务标识\x27,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id,app_id)\x0a\x20\x20\x20\x20)'),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)](_0xe5b434(0x128)),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0x106)),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)]('正在创建事件属性信息表'),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0x11e)),this['logger']['log'](_0xe5b434(0xf2)),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0x11d)),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)](_0xe5b434(0x116)),await this['entityManager']['query'](_0xe5b434(0x134)),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)](_0xe5b434(0x126)),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0x11a)),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)](_0xe5b434(0xf6)),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0x120)),this[_0xe5b434(0xf5)]['log'](_0xe5b434(0x119)),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0xeb)),this[_0xe5b434(0xf5)]['log'](_0xe5b434(0x12e)),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0x11c)),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)](_0xe5b434(0x113)),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)]('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_online_active_peak(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20date\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27日期\x27,\x0a\x20\x20\x20\x20\x20\x20`index`\x20INT(5)\x20NOT\x20NULL\x20COMMENT\x20\x27时间下标\x27,\x0a\x20\x20\x20\x20\x20\x20time\x20INT(1)\x20NOT\x20NULL\x20COMMENT\x20\x271-30秒\x202-分钟\x203-小时\x204-天\x27,\x0a\x20\x20\x20\x20\x20\x20value\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27数值\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index(app_id,date,time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)'),this['logger'][_0xe5b434(0x11b)]('正在创建活跃用户分时统计表'),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)]('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_online_active_trendline(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20date\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27日期\x27,\x0a\x20\x20\x20\x20\x20\x20`index`\x20INT(5)\x20NOT\x20NULL\x20COMMENT\x20\x27时间下标\x27,\x0a\x20\x20\x20\x20\x20\x20time\x20INT(1)\x20NOT\x20NULL\x20COMMENT\x20\x271-30秒\x202-分钟\x203-小时\x204-天\x27,\x0a\x20\x20\x20\x20\x20\x20value\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27数值\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index(app_id,date,time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)'),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)]('正在创建新用户活跃分时统计表'),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)]('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_online_new_active_trendline(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20date\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27日期\x27,\x0a\x20\x20\x20\x20\x20\x20`index`\x20INT(5)\x20NOT\x20NULL\x20COMMENT\x20\x27时间下标\x27,\x0a\x20\x20\x20\x20\x20\x20time\x20INT(1)\x20NOT\x20NULL\x20COMMENT\x20\x271-30秒\x202-分钟\x203-小时\x204-天\x27,\x0a\x20\x20\x20\x20\x20\x20value\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27数值\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index(app_id,date,time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)'),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)](_0xe5b434(0x132)),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0x108)),this['logger'][_0xe5b434(0x11b)](_0xe5b434(0xed)),await this[_0xe5b434(0x109)]['query'](_0xe5b434(0xf9)),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)](_0xe5b434(0x12b)),await this[_0xe5b434(0x109)]['query']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_session\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20year\x20INT(4)\x20NOT\x20NULL\x20COMMENT\x20\x27年分\x27,\x0a\x20\x20\x20\x20\x20\x20type\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x271-天\x202-周\x203-月\x204-季\x205-年\x27,\x0a\x20\x20\x20\x20\x20\x20idx\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x27下标\x27,\x0a\x20\x20\x20\x20\x20\x20start_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27开始时间\x27,\x0a\x20\x20\x20\x20\x20\x20end_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27结束时间\x27,\x0a\x20\x20\x20\x20\x20\x20pv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27活跃会话\x27,\x0a\x20\x20\x20\x20\x20\x20new_pv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27新增会话数\x27,\x0a\x20\x20\x20\x20\x20\x20duration\x20INT(15)\x20NOT\x20NULL\x20COMMENT\x20\x27会话总时长\x27,\x0a\x20\x20\x20\x20\x20\x20duration_avg\x20DECIMAL(8,\x202)\x20NOT\x20NULL\x20COMMENT\x20\x27平均会话时长\x27,\x0a\x20\x20\x20\x20\x20\x20total\x20INT(15)\x20NOT\x20NULL\x20COMMENT\x20\x27累计会话数\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index\x20(app_id,type,year,idx)\x20USING\x20BTREE,\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_day_index\x20(app_id,type,start_time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)'),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)]('正在创建会话时长统计表'),await this['entityManager'][_0xe5b434(0x12d)](_0xe5b434(0x10e)),this[_0xe5b434(0xf5)]['log'](_0xe5b434(0x111)),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)]('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sts_session_frequency(\x0a\x20\x20\x20\x20\x20\x20id\x20INT(11)\x20NOT\x20NULL\x20AUTO_INCREMENT,\x0a\x20\x20\x20\x20\x20\x20app_id\x20VARCHAR(24)\x20NOT\x20NULL\x20COMMENT\x20\x27应用id\x27,\x0a\x20\x20\x20\x20\x20\x20year\x20INT(4)\x20NOT\x20NULL\x20COMMENT\x20\x27年分\x27,\x0a\x20\x20\x20\x20\x20\x20type\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x271-天\x202-周\x203-月\x204-季\x205-年\x27,\x0a\x20\x20\x20\x20\x20\x20idx\x20INT(2)\x20NOT\x20NULL\x20COMMENT\x20\x27下标\x27,\x0a\x20\x20\x20\x20\x20\x20start_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27开始时间\x27,\x0a\x20\x20\x20\x20\x20\x20end_time\x20TIMESTAMP\x20NOT\x20NULL\x20DEFAULT\x20CURRENT_TIMESTAMP\x20COMMENT\x20\x27结束时间\x27,\x0a\x20\x20\x20\x20\x20\x20pv\x20INT(11)\x20NOT\x20NULL\x20COMMENT\x20\x27会话个数\x27,\x0a\x20\x20\x20\x20\x20\x20level\x20VARCHAR(10)\x20NOT\x20NULL\x20COMMENT\x20\x27会话次数区间\x27,\x0a\x20\x20\x20\x20\x20\x20create_time\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x20,\x0a\x20\x20\x20\x20\x20\x20del\x20TINYINT(1)\x20NOT\x20NULL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id),\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_index\x20(app_id,type,year,idx)\x20USING\x20BTREE,\x0a\x20\x20\x20\x20\x20\x20INDEX\x20group_day_index\x20(app_id,type,start_time)\x20USING\x20BTREE\x0a\x20\x20\x20\x20)'),this[_0xe5b434(0xf5)]['log'](_0xe5b434(0x131)),await this['entityManager']['query'](_0xe5b434(0x10a)),this['logger']['log'](_0xe5b434(0x12f)),await this['entityManager']['query'](_0xe5b434(0x133)),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)]('正在创建跳出率统计表'),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0x122)),this[_0xe5b434(0xf5)]['log']('正在创建地域统计表'),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0x117)),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)](_0xe5b434(0xfb)),await this[_0xe5b434(0x109)][_0xe5b434(0x12d)](_0xe5b434(0x130)),this['logger'][_0xe5b434(0x11b)](_0xe5b434(0xf4)),await this['clickhouse']['command'](_0xe5b434(0xf3)),this[_0xe5b434(0xf5)][_0xe5b434(0x11b)](_0xe5b434(0x110)),await this[_0xe5b434(0xfd)][_0xe5b434(0x101)]();}};BootstrapService=BootstrapService_1=__decorate([(0x0,common_1[_0x2b4e27(0x129)])(),__metadata(_0x2b4e27(0xff),[typeorm_1[_0x2b4e27(0xfe)],clickhouse_service_1[_0x2b4e27(0xfc)],metrics_service_1[_0x2b4e27(0xef)]])],BootstrapService),exports['BootstrapService']=BootstrapService;